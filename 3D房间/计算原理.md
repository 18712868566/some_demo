##3D坐标计算原理

####计划结构如下：

舞台元素

————】动画容器之根元素

————————】动画容器一

————————————】动画元素1、2、3……

————————】动画容器二

————————】动画容器三


####3D移动原理

1. 由于所有的 *动画元素* 相对于 *动画容器* 的坐标是固定的；
2. *动画容器元素* 相对于 *动画容器根元素* 是固定的；
3. 因此，只需要控制 *动画容器跟元素* 的旋转坐标圆心和旋转角度，即可形成整个场景的变换。
4. 可能存在的潜在缺陷：假如场景里的结点很多，也许会有性能方面的问题？不确定。
5. 有没有替代的方案？不确定


####计算函数

基础属性：

    var xyz = {
        x: 250,     //xyz的坐标
        y: 250,
        z: 0,
        rotate: 0   //面向角度
    }
    
角度弧度换算：

    //通过角度来得到弧度
    function getRadianFromAngle(angle) {
        return angle * Math.PI / 180;
    }
    
XZ平面上前进的计算函数：

    //前进的话，根据角度计算坐标变化
    function goFrontAndGetNewValue() {
        var radian = getRadianFromAngle(xyz.rotate);
        var x = Math.sin(radian) * 50;
        var z = Math.cos(radian) * 50;
        x = Number(x.toFixed(2));
        z = Number(z.toFixed(2));
        //首先让rotate的值是0~359之间
        if (xyz.rotate >= 360) {
            xyz.rotate -= 360;
        } else if (xyz.rotate < 0) {
            xyz.rotate += 360;
        }
        if (xyz.rotate < 90) {
            //右上方角度
            xyz.x += x;
            xyz.z -= z;
            console.log("右上");
        } else if (xyz.rotate < 180) {
            //右下方角度
            xyz.x += x;
            xyz.z -= z;
            console.log("右下");
        } else if (xyz.rotate < 270) {
            //左下方角度
            xyz.x += x;
            xyz.z -= z;
            console.log("左下");
        } else if (xyz.rotate < 360) {
            //左上方角度
            xyz.x += x;
            xyz.z -= z;
            console.log("左上");
        }
        console.log(xyz);
    }
    
前进行为完成的函数：

    //先计算坐标变化，然后计算当前的坐标中心（方便之后旋转）

    //前进
    function GoAhead() {
        var transformValue = parent.style.transform;
        goFrontAndGetNewValue();
        //先设置位移
        var newString = 'translate3d(' + (-xyz.x) + 'px,' + 0 + 'px,' + (-xyz.z) + 'px)';
        parent.style.transform = transformValue.replace(/translate3d\([^)]+\)/, newString);

        //然后设置当前旋转中心
        var originValue = String(250 + xyz.x) + 'px ' + String(250 + xyz.y) + 'px ' + String(xyz.z) + 'px';
        console.log(originValue);
        parent.style['transform-origin'] = originValue;
    }
    
后退同理，其中计算坐标变化的函数，把+x变为-x（-x变为+x），z轴同理，变换正负即可。

